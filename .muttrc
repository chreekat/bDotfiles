reset all
unhook *

# Colllapse threads on viewing a folder
folder-hook . exec collapse-all

folder-hook .              set sort_aux = reverse-last-date-received
folder-hook "INBOX|action" set sort_aux = last-date-received
folder-hook "INBOX|action" exec first-entry

alternates bryan.richter@gmail.com chreekat@gmail.com

mailboxes +INBOX +drafts +sent +starred +trash +archive +@action +@waiting_for +recent

# Time before cancelling a connect attempt.
set   connect_timeout=5

set beep_new          = yes
set beep              = no
set confirmappend     = no
set copy              = no
set delete            = yes
set folder            = $HOME/Mail
set forward_format    = "Fwd: %s"
set from              = "bryan.richter@gmail.com"
set help              = no
set include           = yes
set markers           = no
set mark_old          = no
set mbox_type         = Maildir
set menu_scroll
set pager_context     = 2
set pager_index_lines = 10
set pager_stop
set postponed         = +drafts
set realname          = "Bryan Richter"
set record            = "this/is/ignored"
set reverse_name
set sleep_time        = 0
set smart_wrap
set smtp_pass         = "`passgm`"
set smtp_url          = smtps://bryan.richter@smtp.gmail.com
set sort              = threads
set spoolfile         = +INBOX
set ssl_force_tls     = yes
set wait_key          = no


macro index ,R "<enter-command>source ~/.muttrc<enter>" "Reload .muttrc"
macro pager ,R "<exit>,R<enter>"                        "Reload .muttrc"
bind pager b previous-page

# gmail-mimic macros

#macro index,pager \# <save-message>=[Gmail].Trash     "Trash a Google message"

macro index,pager A "<pipe-message>goobook add<enter><shell-escape>goobook reload<enter>" "add the sender address to Google contacts"
bind index,pager a group-reply
bind index,pager c mail
bind index,pager m change-folder

macro index,pager Sa <save-message>+@action<enter>           "Apply @action label and archive"
macro index,pager Sw <save-message>+@waiting_for<enter>      "Apply @waiting_for label and archive"

macro index,pager ga <change-folder>+@action<enter>      " Go to @action label      "
macro index,pager gw <change-folder>+@waiting_for<enter> " Go to @waiting_for label "
macro index,pager gr <change-folder>+recent<enter>       " Go to recent mail folder "
macro index,pager gi <change-folder>+INBOX<enter>        " Go to Google inbox       "
macro index,pager gd <change-folder>+drafts<enter>       " Go to Google drafts      "
macro index,pager gs <change-folder>+starred<enter>      " Go to starred messages   "

# Offlineimap awayy
macro index,pager O "<shell-escape>offlineimap<enter>"           "run offlineimap to sync all mail"
macro index,pager o "<shell-escape>offlineimap -qf INBOX,@action<enter>" "run offlineimap to sync inbox"

set query_command = "goobook query %s"
set certificate_file = "~/.mutt/certificates"

source ~/.mutt/solarized.muttrc

# Losh was right about this
macro index,pager C <copy-message>?<tab>
macro index,pager s <save-message>?<tab>

# Something to mark a whole folder as 'read'
# Line by line,
# 1. Tag all Unread or Old messages
# 2. If any messages are tagged, [macro aborts otherwise]
# 3. Clear the Unread flag
# 4. Clear the Old flag
# 5. Untag all messages
macro index <esc>m '\
<tag-pattern>~N|~O<enter>\
<tag-prefix-cond>\
<tag-prefix><clear-flag>N\
<tag-prefix><clear-flag>O\
<untag-pattern>~T<enter>'             "mark all messages read"

source ~/.mutt/crypto.rc
