#
# RESET (makes reloading configuration work nicely)
#

reset all
unhook *
unmailboxes *

#
# Defaults and Includes
#

source ~/.mutt/defaults.muttrc
source ~/.mutt/crypto.rc
#source ~/.mutt/subscriptions
#source ~/.mutt/lunatic-mutt/lunatic.muttrc
#source ~/.mutt/default-color.muttrc

#
# Accounts, subscriptions, and other personal things.
#


#set spoolfile = +B_Chreekat/INBOX
#set smtp_pass = "`passgm google.com b@chreekat.net`" ; \

# Lets us not worry about one folder fucking up another folder

set imap_user = "bryan.richter@relex.fi"
set imap_pass = "`pass outlook`"
set smtp_pass = "`pass outlook`"
set folder = "imaps://outlook.office365.com"
set spoolfile = "+INBOX"
#mailboxes "+INBOX" "+Needs action" "+Archive" "+I#
set imap_check_subscribed = yes

set from = "bryan.richter@relexsolutions.com"
set smtp_user = "bryan.richter@relex.fi"
set smtp_pass = "`pass outlook`"
set smtp_url = "smtp://smtp.office365.com"
set trash = "+Archive"
folder-hook Relex color status brightcolor0 color5

alternates -group me -group work bryan.richter@relexsolutions.com bryan.richter@relex.fi

#
# Sensible defaults
#

# Collapse threads on viewing a folder
folder-hook . exec collapse-all
folder-hook . exec first-entry


# Headers to show by default
ignore   *
unignore To:
unignore Subject:
unignore From:
unignore Date:
unignore Cc:

auto_view text/html

message-hook . "unalternative_order *"
message-hook "! ~f flowdock.com" "alternative_order text/plain text"
message-hook flowdock.com "alternative_order text/html"

#
# extract_url config
#
macro index,pager ,b "<enter-command> set my_pdsave=\$pipe_decode<enter>\
<enter-command> unset pipe_decode<enter>\
<pipe-message>extract_url<enter>\
<enter-command> set pipe_decode=\$my_pdsave<enter>" "get URLs"

macro index,pager ,B "<enter-command> set my_pdsave=\$pipe_decode<enter>\
<enter-command> set pipe_decode<enter>\
<pipe-message>extract_url<enter>\
<enter-command> set pipe_decode=\$my_pdsave<enter>" "decrypt message, then get URLs"

folder-hook . 'macro index,pager \cb ,b "URL viewer"'
message-hook . 'macro index,pager \cb ,b "URL viewer"'
message-hook ~G 'macro index,pager \cb ,B "URL viewer"'

#
# Sketchy configurations
#

macro pager <Esc>v <exit><collapse-thread>
