reset all
unhook *

# Colllapse threads on viewing a folder
folder-hook . exec collapse-all

folder-hook .              set sort_aux = reverse-last-date-received
folder-hook "INBOX|action" set sort_aux = last-date-received
folder-hook "INBOX|action" exec first-entry

# Time before cancelling a connect attempt.
set   connect_timeout=5

set beep_new          = yes
set beep              = no
unset collapse_unread
set confirmappend     = no
set copy              = no
set delete            = yes
set forward_format    = "Fwd: %s"
set help              = no
set include           = yes
set mark_old          = no
set mbox_type         = Maildir
set pager_context     = 2
set pager_stop
set postponed         = +drafts
set realname          = "Bryan Richter"
set recall = no # Recall manually with R
set record            = "this/is/ignored"
# Mainly so I have my own name for mailing lists
set reverse_alias
set sleep_time        = 0
set smart_wrap
set sort              = threads
set ssl_force_tls     = yes
set strict_threads    = yes
set tmpdir            = ~/tmp
set wait_key          = no

ignore *
unignore To:
unignore Subject:
unignore From:
unignore Date:
unignore Cc:

auto_view text/html

# Jump to the w3m view of the html attachment
macro index ,h v*<enter>q
macro pager ,h qv*<enter>q<enter>

# Change a file's type to application/pgp â€” necessary for inline pgp
macro index,pager ,p "<edit-type>application/pgp<enter>" "Change to pgp"

macro index ,R "<enter-command>source ~/.muttrc<enter>" "Reload .muttrc"
macro pager ,R "<exit>,R<enter>"                        "Reload .muttrc"
bind pager b previous-page

bind index,pager m change-folder
# macro index,pager m "<change-folder>?<tab>"

# gmail-mimic macros

#macro index,pager \# <save-message>=[Gmail].Trash     "Trash a Google message"

bind index,pager a group-reply
bind index,pager c mail

macro index,pager Sa <save-message>+@action<enter>           "Apply @action label and archive"
macro index,pager Sw <save-message>+@waiting_for<enter>      "Apply @waiting_for label and archive"
macro index,pager Ss <save-message>+starred<enter>           "Star and archive"

macro index,pager ga <change-folder>+@action<enter>      " Go to @action label      "
macro index,pager gw <change-folder>+@waiting_for<enter> " Go to @waiting_for label "
macro index,pager gr <change-folder>+recent<enter>       " Go to recent"
macro index,pager gi <change-folder>+INBOX<enter>        " Go to Google inbox       "
macro index,pager gd <change-folder>+drafts<enter>       " Go to Google drafts      "
macro index,pager gs <change-folder>+starred<enter>      " Go to starred messages   "

macro pager <Esc>v <exit><collapse-thread>

set certificate_file = "~/.mutt/certificates"

source ~/.mutt/lunatic-mutt/lunatic.muttrc

# Losh was right about this
macro index,pager C <copy-message>?<tab>
macro index,pager s <save-message>?<tab>

# Something to mark a whole folder as 'read'
# Line by line,
# 1. Tag all Unread or Old messages
# 2. If any messages are tagged, [macro aborts otherwise]
# 3. Clear the Unread flag
# 4. Clear the Old flag
# 5. Untag all messages
macro index <esc>m '\
<tag-pattern>~N|~O<enter>\
<tag-prefix-cond>\
<tag-prefix><clear-flag>N\
<tag-prefix><clear-flag>O\
<untag-pattern>~T<enter>'             "mark all messages read"

source ~/.mutt/crypto.rc

folder-hook '.*Barobo.*' source ~/.mutt/account_barobo.rc
folder-hook '.*Personal.*' source ~/.mutt/account_personal.rc
# folder-hook '.*snowdrift-mail.*' source ~/.mutt/account_snowdrift.rc

#set spoolfile = ~/Mail/`~/lib/worktime`/INBOX
set spoolfile = ~/Mail/Personal/INBOX

# Subscribe to snowdrift mailing lists
subscribe .*@lists.snowdrift.coop

alias snowdev dev@lists.snowdrift.coop (Snow Dev)
alias snowdiscuss discuss@lists.snowdrift.coop (Snow Discuss)
alias snowteam team@lists.snowdrift.coop (Snow Team)

send2-hook lists.snowdrift.coop "set crypt_autosign = yes"
